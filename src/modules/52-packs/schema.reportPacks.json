{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ReportPack",
  "description": "Document package for advisors, auditors, banks, or legal counsel",
  "type": "object",
  "required": ["id", "clientId", "name", "recipientJson", "purpose", "scopeJson", "periodJson", "clientSafe", "sensitivityKey", "watermarkKey", "statusKey", "createdByUserId", "createdAt"],
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique pack identifier"
    },
    "clientId": {
      "type": "string",
      "description": "Client/family identifier"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "description": "Pack name"
    },
    "recipientJson": {
      "type": "object",
      "description": "Recipient information",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["auditor", "bank", "tax", "legal", "committee", "investor", "regulator", "other"]
        },
        "org": {
          "type": "string",
          "description": "Organization name"
        },
        "contactEmail": {
          "type": "string",
          "format": "email",
          "description": "Optional contact email"
        },
        "contactName": {
          "type": "string",
          "description": "Contact person name"
        }
      },
      "required": ["type", "org"]
    },
    "purpose": {
      "type": "string",
      "minLength": 1,
      "maxLength": 500,
      "description": "Purpose of the pack"
    },
    "scopeJson": {
      "type": "object",
      "description": "Scope of the pack",
      "properties": {
        "scopeType": {
          "type": "string",
          "enum": ["household", "entity", "portfolio", "global"]
        },
        "scopeId": {
          "type": "string",
          "description": "Optional specific entity/portfolio ID"
        },
        "scopeName": {
          "type": "string",
          "description": "Human-readable scope name"
        }
      },
      "required": ["scopeType"]
    },
    "periodJson": {
      "type": "object",
      "description": "Reporting period",
      "properties": {
        "start": {
          "type": "string",
          "format": "date"
        },
        "end": {
          "type": "string",
          "format": "date"
        },
        "label": {
          "type": "string",
          "description": "Period label e.g. FY2024, Q4 2024"
        }
      },
      "required": ["start", "end"]
    },
    "clientSafe": {
      "type": "boolean",
      "default": false,
      "description": "Client-safe mode - excludes internal notes"
    },
    "sensitivityKey": {
      "type": "string",
      "enum": ["low", "medium", "high"],
      "default": "medium",
      "description": "Sensitivity level"
    },
    "watermarkKey": {
      "type": "string",
      "enum": ["on", "off"],
      "default": "on",
      "description": "Watermark setting"
    },
    "statusKey": {
      "type": "string",
      "enum": ["draft", "pending_approval", "approved", "shared", "closed"],
      "default": "draft",
      "description": "Pack status"
    },
    "templateId": {
      "type": "string",
      "description": "Optional template ID if created from template"
    },
    "coverLetterMd": {
      "type": "string",
      "description": "Generated cover letter in markdown"
    },
    "itemsCount": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of items in pack"
    },
    "createdByUserId": {
      "type": "string",
      "description": "User who created the pack"
    },
    "approvedByUserId": {
      "type": "string",
      "description": "User who approved the pack"
    },
    "approvedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Approval timestamp"
    },
    "createdAt": {
      "type": "string",
      "format": "date-time"
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time"
    }
  }
}
