# Качество данных и Observability

## Что такое Data Quality в MFO?

Контроль качества данных — критически важная функция для Multi-Family Office. Без уверенности в целостности и актуальности данных невозможно доверять:
- Расчётам Net Worth
- Отчётам по GL и бухгалтерии
- Перформанс-аналитике
- Клиентским отчётам

## Health Score

**Health Score** — общий показатель качества данных от 0 до 100:
- **90-100**: Отличное качество, незначительные проблемы
- **70-89**: Хорошее качество, требуется внимание к некоторым областям
- **50-69**: Удовлетворительное, есть существенные проблемы
- **<50**: Критическое состояние, данным нельзя доверять

### As-of дата

Важно отслеживать **as-of дату** данных — дату, на которую данные актуальны. Устаревшие данные снижают Health Score.

## Правила (Rules)

Правила определяют, какие проверки выполняются:
- **Missing Field**: обязательные поля не заполнены
- **Invalid Currency**: неизвестная или неверная валюта
- **Duplicate**: возможные дубликаты записей
- **Mismatch Sum**: несовпадение контрольных сумм
- **Stale As-of**: данные устарели

Каждое правило имеет:
- Целевую коллекцию и поля
- Severity по умолчанию
- Флаг автосоздания задачи

## Исключения (Exceptions)

Исключения — конкретные проблемы, найденные правилами:
- **Critical**: требует исправления в 24 часа
- **Warning**: требует исправления в 72 часа
- **Info**: требует исправления в 7 дней

### SLA

Каждое исключение имеет SLA — срок, к которому проблема должна быть решена.

## Конфликты (Conflicts)

Конфликты возникают при:
- Дублировании транзакций
- Несовпадении валют в одном счёте
- Отсутствии владельца записи
- Расхождении позиций

Решение конфликта: выбрать одну из записей, объединить или удалить обе.

## Сверки (Reconciliation)

Автоматические сверки между источниками:
- **IBOR vs ABOR**: сравнение инвестиционных и бухгалтерских позиций
- **Bank vs Ledger**: сравнение банковских выписок с GL
- **Positions vs Statements**: сравнение позиций с отчётами брокеров

## Синхронизации (Sync Jobs)

Мониторинг интеграций с внешними системами:
- Статус последнего запуска
- История попыток
- Автоматический retry при ошибках
- Уведомления о проблемах

## Remediation Workflow

Процесс исправления проблем:
1. Создать задачу из исключения
2. Назначить ответственного
3. Исправить данные
4. Закрыть исключение с указанием причины
5. Перезапустить проверки

## AI-резюме

Система автоматически генерирует:
- Топ-5 рисков
- Рекомендуемые действия
- Приоритизацию проблем

---

**Дисклеймер**: Проверки качества данных в MVP демонстрационные и не заменяют полный аудит данных. Для production-использования требуется настройка правил под конкретные бизнес-требования.
