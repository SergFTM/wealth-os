# Центр безопасности (Security Center)

## Обзор
Security Center — модуль управления безопасностью, идентификацией и доступом (IAM) в Wealth OS. Обеспечивает полный контроль над пользователями, ролями, разрешениями и сессиями.

## IAM сущности

### Пользователи (Users)
- Учётные записи сотрудников и клиентов
- Статусы: active, suspended
- MFA настройки
- История входов

### Роли (Roles)
- Предопределённые: Owner, CIO, CFO, Operations, Compliance, RM, Advisor, Client
- Кастомные роли
- Client-safe политики для клиентского режима

### Группы (Groups)
- Объединение пользователей
- Назначение ролей группам
- Упрощённое управление доступами

### Разрешения (Permissions)
- Матрица: модуль × действие × scope
- Действия: view, create, edit, approve, export
- Scopes: global, household, entity, portfolio
- Client-safe разрешения отдельно

## RBAC by Design

### Принцип работы
1. Пользователю назначается роль (Role Binding)
2. Роль содержит набор разрешений
3. Каждое разрешение определяет доступ к модулю/действию/scope
4. При запросе проверяется цепочка: user → binding → role → permission

### Client-safe режим
- Специальный режим для демонстрации клиентам
- Скрывает внутренние заметки и комментарии
- Ограничивает экспорт данных
- Настраивается в permissions отдельным флагом

## MFA и сессии

### Многофакторная аутентификация
- Методы: Authenticator App, SMS, Hardware Token
- Обязательность настраивается в Security Settings
- Статусы: enrolled, not_enrolled, pending

### Управление сессиями
- Отслеживание активных сессий
- Информация: устройство, браузер, IP (маскированный), локация
- Отзыв сессий при подозрительной активности
- Пометка сессий как подозрительных

## Access Reviews

### Что это
Периодические ревью прав доступа для compliance и безопасности.

### Процесс
1. **Создание ревью** — определение scope (роль, модуль, период)
2. **Генерация аттестаций** — для каждого пользователя в scope
3. **Ревью** — reviewer проверяет каждый binding
4. **Решения**: keep, revoke, modify
5. **Ремедиация** — создание задач на изменение прав
6. **Закрытие** — финализация и отчёт

### Типы ревью
- По роли — все пользователи с определённой ролью
- По модулю — все пользователи с доступом к модулю
- Глобальный — все bindings

## Инциденты безопасности

### Типы инцидентов
- **Suspicious Login** — вход с нового устройства/локации
- **Policy Violation** — нарушение политики (массовый экспорт)
- **MFA Bypass** — попытка обхода MFA
- **Data Export** — крупный экспорт данных
- **Role Change** — несанкционированное изменение прав

### Severity
- Low — информационный
- Medium — требует внимания
- High — требует быстрого реагирования
- Critical — немедленная эскалация

### Расследование
1. Просмотр evidence (аудит записи)
2. Анализ timeline
3. Remediation: revoke session, require MFA, revoke role
4. Resolution notes и закрытие

## Audit Logs

### Назначение
- Доказательная база для compliance
- Forensic analysis
- Отладка проблем с доступом

### Что логируется
- Все CRUD операции
- Изменения прав доступа
- Входы и выходы
- Экспорт данных
- Изменения настроек

### Фильтры
- Module, Action, Actor, Severity
- Record ID, Scope
- Date range

### Saved Views
Сохранённые наборы фильтров для быстрого доступа.

## Настройки безопасности

### Tenant Meta
- **Dedicated URL** — отдельный домен для клиента
- **AWS Region** — регион хранения данных
- **Isolation Mode** — shared/dedicated инфраструктура

### Политики
- **Password Policy** — требования к паролям
- **Session Timeout** — автоматический выход
- **MFA Required** — обязательность MFA

### SSO (placeholder)
- SAML 2.0
- OAuth 2.0 / OIDC
- Active Directory

### Data Retention
- Срок хранения аудит логов
- Политика удаления данных

## Client Safe Preview

### Назначение
Предпросмотр того, что видит клиент в client-safe режиме.

### Возможности
- Выбор роли клиента
- Просмотр доступных модулей
- Проверка скрытых полей
- Таблица client-safe политики

---

## ⚠️ Дисклеймер

**В MVP безопасность демонстрационная.** Для production требуется:
- Настройка инфраструктуры безопасности
- Интеграция с внешними IdP (Okta, Auth0, Azure AD)
- Настройка шифрования данных
- Penetration testing
- SOC 2 / ISO 27001 compliance
